\documentclass[11pt, letterpaper]{article}

\begin{document}

\section{Notation}
$M_O$: Marker pose in Optitrack frame.

$C_G$: Camera pose in Gazebo frame. Represented in code by variable userCameraPose.

$M_C$: Marker pose in camera frame. Represented in code by cameraToOptitrackHead.

$M_G$: Marker pose in Gazebo frame.

$O_G$: Gazebo to Optitrack transform. Represented in code by variable optitrackHeadOffset.

All pose arithmetic done in the convention of Gazebo pose math, where $A$ is
the transform from $O$ to $P$ specified in frame $O$ (denoted $P_O$) and $B$
is the transform from $P$ to $Q$ specified in frame $P$ ($Q_P$) then

\begin{equation}
B + A = Q_O
\end{equation}

\section{Calculations}
\subsection{Paused}
Calculations at time $t$ when motion tracking is paused:

\begin{equation}
M_G = M_C + C_G
\end{equation}
\begin{equation}
O_G = O_M + M_G = -M_O + M_G
\end{equation}

\subsection{Running}
Calculations at time $t$ when motion tracking is running:

\begin{equation}
M_G = M_O + O_G
\end{equation}
\begin{equation}
C_G = C_M + M_G = -M_C + M_G
\end{equation}

Publish $C_G$ as the new pose of the Gazebo user camera.

\end{document}
